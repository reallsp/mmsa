MMSA - ======================================== Program Start ========================================
MMSA - Running with args:
MMSA - {'model_name': 'tfn', 'dataset_name': 'custom', 'featurePath': 'train_12.16_1_converted.pkl', 'seq_lens': [50, 512, 197], 'feature_dims': [768, 13, 768], 'train_samples': 256, 'num_classes': 2, 'language': 'en', 'KeyEval': 'Loss', 'missing_rate': [0.2, 0.2, 0.2], 'missing_seed': [1111, 1111, 1111], 'need_data_aligned': False, 'need_model_aligned': False, 'need_normalized': True, 'early_stop': 8, 'hidden_dims': [128, 32, 128], 'text_out': 32, 'post_fusion_dim': 64, 'dropouts': [0.3, 0.3, 0.3, 0.5], 'batch_size': 16, 'learning_rate': 0.001, 'model_save_path': PosixPath('/root/MMSA/saved_models/tfn-custom.pth'), 'device': device(type='cuda', index=0), 'train_mode': 'regression', 'custom_feature': None, 'feature_T': None, 'feature_A': None, 'feature_V': None}
MMSA - Seeds: [1111]
MMSA - ------------------------------ Running with seed 1111 [1/1] ------------------------------
MMSA - train samples: (256,)
MMSA - valid samples: (55,)
MMSA - test samples: (55,)
MMSA - The model has 9594555 trainable parameters
======================================================================
GPU训练模式
======================================================================
✓ 检测到 1 个GPU:
  GPU 0: NVIDIA GeForce RTX 3080 Ti

使用GPU: 0

模型: TFN
数据集: custom
随机种子: 1111
======================================================================
  0%|          | 0/16 [00:00<?, ?it/s]/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/rnn.py:879: UserWarning: RNN module weights are not part of single contiguous chunk of memory. This means they need to be compacted at every call, possibly greatly increasing memory usage. To compact weights again call flatten_parameters(). (Triggered internally at ../aten/src/ATen/native/cudnn/RNN.cpp:982.)
  result = _VF.lstm(input, hx, self._flat_weights, self.bias, self.num_layers,
  0%|          | 0/16 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/root/mmsa/train_gpu.py", line 35, in <module>
    results = MMSA_run(
  File "/root/mmsa/src/MMSA/run.py", line 223, in MMSA_run
    result = _run(args, num_workers, is_tune)
  File "/root/mmsa/src/MMSA/run.py", line 259, in _run
    epoch_results = trainer.do_train(model, dataloader, return_epoch_results=from_sena)
  File "/root/mmsa/src/MMSA/trains/singleTask/TFN.py", line 51, in do_train
    outputs = model(text, audio, vision)['M']
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/mmsa/src/MMSA/models/AMIO.py", line 60, in forward
    return self.Model(text_x, audio_x, video_x, *args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/mmsa/src/MMSA/models/singleTask/TFN.py", line 71, in forward
    text_h = self.text_subnet(text_x)
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/mmsa/src/MMSA/models/subNets/FeatureNets.py", line 73, in forward
    _, final_states = self.rnn(x)
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/lib/python3.10/site-packages/torch/nn/modules/rnn.py", line 879, in forward
    result = _VF.lstm(input, hx, self._flat_weights, self.bias, self.num_layers,
RuntimeError: shape '[25600, 1]' is invalid for input of size 393216
