MMSA - ======================================== Program Start ========================================
MMSA - Running with args:
MMSA - {'model_name': 'tfn', 'dataset_name': 'custom', 'featurePath': 'train_12.16_1_converted.pkl', 'seq_lens': [50, 512, 197], 'feature_dims': [768, 13, 768], 'train_samples': 256, 'num_classes': 2, 'language': 'en', 'KeyEval': 'Loss', 'missing_rate': [0.2, 0.2, 0.2], 'missing_seed': [1111, 1111, 1111], 'need_data_aligned': False, 'need_model_aligned': False, 'need_normalized': True, 'early_stop': 8, 'hidden_dims': [128, 32, 128], 'text_out': 32, 'post_fusion_dim': 64, 'dropouts': [0.3, 0.3, 0.3, 0.5], 'batch_size': 16, 'learning_rate': 0.001, 'model_save_path': PosixPath('/root/MMSA/saved_models/tfn-custom.pth'), 'device': device(type='cpu'), 'train_mode': 'regression', 'custom_feature': None, 'feature_T': None, 'feature_A': None, 'feature_V': None}
MMSA - Seeds: [1111]
MMSA - ------------------------------ Running with seed 1111 [1/1] ------------------------------
MMSA - train samples: (256,)
MMSA - valid samples: (55,)
MMSA - test samples: (55,)
MMSA - The model has 9594555 trainable parameters
======================================================================
开始训练模型（CPU模式）
======================================================================
模型: TFN
数据集: custom
随机种子: 1111
======================================================================
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.57it/s] 31%|███▏      | 5/16 [00:00<00:00, 19.03it/s] 56%|█████▋    | 9/16 [00:00<00:00, 26.61it/s] 88%|████████▊ | 14/16 [00:00<00:00, 31.96it/s]100%|██████████| 16/16 [00:00<00:00, 26.81it/s]
MMSA - TRAIN-(tfn) [1/1/1] >> loss: 0.8331  Has0_acc_2: 0.7031  Has0_F1_score: 0.6617  Non0_acc_2: 0.7031  Non0_F1_score: 0.6617  Mult_acc_5: 0.2539  Mult_acc_7: 0.2539  MAE: 0.8331  Corr: 0.0691 
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 31.74it/s]
MMSA - VAL-(tfn) >>  Has0_acc_2: 0.7273  Has0_F1_score: 0.6124  Non0_acc_2: 0.7273  Non0_F1_score: 0.6124  Mult_acc_5: 0.2545  Mult_acc_7: 0.2545  MAE: 0.7720  Corr: -0.1504  Loss: 0.7870 
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.91it/s] 31%|███▏      | 5/16 [00:00<00:00, 21.27it/s] 62%|██████▎   | 10/16 [00:00<00:00, 29.81it/s] 94%|█████████▍| 15/16 [00:00<00:00, 34.24it/s]100%|██████████| 16/16 [00:00<00:00, 27.21it/s]
MMSA - TRAIN-(tfn) [1/2/1] >> loss: 0.682  Has0_acc_2: 0.7148  Has0_F1_score: 0.5960  Non0_acc_2: 0.7148  Non0_F1_score: 0.5960  Mult_acc_5: 0.6992  Mult_acc_7: 0.6992  MAE: 0.6820  Corr: 0.0579 
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 32.36it/s]
MMSA - VAL-(tfn) >>  Has0_acc_2: 0.7273  Has0_F1_score: 0.6124  Non0_acc_2: 0.7273  Non0_F1_score: 0.6124  Mult_acc_5: 0.7273  Mult_acc_7: 0.7273  MAE: 0.6173  Corr: 0.2596  Loss: 0.5847 
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.27it/s] 38%|███▊      | 6/16 [00:00<00:00, 26.14it/s] 75%|███████▌  | 12/16 [00:00<00:00, 36.87it/s]100%|██████████| 16/16 [00:00<00:00, 29.28it/s]
MMSA - TRAIN-(tfn) [1/3/1] >> loss: 0.6411  Has0_acc_2: 0.7148  Has0_F1_score: 0.5960  Non0_acc_2: 0.7148  Non0_F1_score: 0.5960  Mult_acc_5: 0.7070  Mult_acc_7: 0.7070  MAE: 0.6411  Corr: 0.2984 
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 34.46it/s]
MMSA - VAL-(tfn) >>  Has0_acc_2: 0.7273  Has0_F1_score: 0.6124  Non0_acc_2: 0.7273  Non0_F1_score: 0.6124  Mult_acc_5: 0.7091  Mult_acc_7: 0.7091  MAE: 0.6778  Corr: -0.0209  Loss: 0.6547 
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.27it/s] 44%|████▍     | 7/16 [00:00<00:00, 30.86it/s] 88%|████████▊ | 14/16 [00:00<00:00, 44.09it/s]100%|██████████| 16/16 [00:00<00:00, 33.66it/s]
MMSA - TRAIN-(tfn) [2/4/1] >> loss: 0.6402  Has0_acc_2: 0.7148  Has0_F1_score: 0.5960  Non0_acc_2: 0.7148  Non0_F1_score: 0.5960  Mult_acc_5: 0.7031  Mult_acc_7: 0.7031  MAE: 0.6402  Corr: 0.2104 
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 29.29it/s]
MMSA - VAL-(tfn) >>  Has0_acc_2: 0.7273  Has0_F1_score: 0.6124  Non0_acc_2: 0.7273  Non0_F1_score: 0.6124  Mult_acc_5: 0.6727  Mult_acc_7: 0.6727  MAE: 0.6189  Corr: 0.2553  Loss: 0.6405 
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.69it/s] 38%|███▊      | 6/16 [00:00<00:00, 25.20it/s] 69%|██████▉   | 11/16 [00:00<00:00, 34.30it/s] 94%|█████████▍| 15/16 [00:00<00:00, 34.63it/s]100%|██████████| 16/16 [00:00<00:00, 27.45it/s]
MMSA - TRAIN-(tfn) [3/5/1] >> loss: 0.5987  Has0_acc_2: 0.7148  Has0_F1_score: 0.5960  Non0_acc_2: 0.7148  Non0_F1_score: 0.5960  Mult_acc_5: 0.6992  Mult_acc_7: 0.6992  MAE: 0.5987  Corr: 0.4717 
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 39.75it/s]
MMSA - VAL-(tfn) >>  Has0_acc_2: 0.7273  Has0_F1_score: 0.6124  Non0_acc_2: 0.7273  Non0_F1_score: 0.6124  Mult_acc_5: 0.5636  Mult_acc_7: 0.5636  MAE: 0.6573  Corr: 0.3016  Loss: 0.6435 
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.91it/s] 44%|████▍     | 7/16 [00:00<00:00, 29.39it/s] 75%|███████▌  | 12/16 [00:00<00:00, 36.70it/s]100%|██████████| 16/16 [00:00<00:00, 29.05it/s]
MMSA - TRAIN-(tfn) [4/6/1] >> loss: 0.5866  Has0_acc_2: 0.7617  Has0_F1_score: 0.7089  Non0_acc_2: 0.7617  Non0_F1_score: 0.7089  Mult_acc_5: 0.6680  Mult_acc_7: 0.6680  MAE: 0.5866  Corr: 0.4475 
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 38.08it/s]
MMSA - VAL-(tfn) >>  Has0_acc_2: 0.7091  Has0_F1_score: 0.7185  Non0_acc_2: 0.7091  Non0_F1_score: 0.7185  Mult_acc_5: 0.4545  Mult_acc_7: 0.4545  MAE: 0.7317  Corr: 0.3859  Loss: 0.6896 
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.60it/s] 44%|████▍     | 7/16 [00:00<00:00, 31.12it/s] 81%|████████▏ | 13/16 [00:00<00:00, 39.65it/s]100%|██████████| 16/16 [00:00<00:00, 30.54it/s]
MMSA - TRAIN-(tfn) [5/7/1] >> loss: 0.6379  Has0_acc_2: 0.7344  Has0_F1_score: 0.6847  Non0_acc_2: 0.7344  Non0_F1_score: 0.6847  Mult_acc_5: 0.6719  Mult_acc_7: 0.6719  MAE: 0.6379  Corr: 0.3182 
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 37.12it/s]
MMSA - VAL-(tfn) >>  Has0_acc_2: 0.7273  Has0_F1_score: 0.6124  Non0_acc_2: 0.7273  Non0_F1_score: 0.6124  Mult_acc_5: 0.7273  Mult_acc_7: 0.7273  MAE: 0.5810  Corr: 0.3313  Loss: 0.6178 
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.77it/s] 38%|███▊      | 6/16 [00:00<00:00, 25.09it/s] 69%|██████▉   | 11/16 [00:00<00:00, 32.15it/s]100%|██████████| 16/16 [00:00<00:00, 36.33it/s]100%|██████████| 16/16 [00:00<00:00, 27.62it/s]
MMSA - TRAIN-(tfn) [6/8/1] >> loss: 0.5994  Has0_acc_2: 0.7148  Has0_F1_score: 0.5960  Non0_acc_2: 0.7148  Non0_F1_score: 0.5960  Mult_acc_5: 0.7148  Mult_acc_7: 0.7148  MAE: 0.5994  Corr: 0.3914 
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 37.66it/s]
MMSA - VAL-(tfn) >>  Has0_acc_2: 0.7273  Has0_F1_score: 0.6124  Non0_acc_2: 0.7273  Non0_F1_score: 0.6124  Mult_acc_5: 0.6727  Mult_acc_7: 0.6727  MAE: 0.5948  Corr: 0.2177  Loss: 0.5655 
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.38it/s] 44%|████▍     | 7/16 [00:00<00:00, 30.22it/s] 81%|████████▏ | 13/16 [00:00<00:00, 38.41it/s]100%|██████████| 16/16 [00:00<00:00, 30.38it/s]
MMSA - TRAIN-(tfn) [1/9/1] >> loss: 0.5716  Has0_acc_2: 0.7344  Has0_F1_score: 0.6394  Non0_acc_2: 0.7344  Non0_F1_score: 0.6394  Mult_acc_5: 0.6992  Mult_acc_7: 0.6992  MAE: 0.5716  Corr: 0.5065 
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 37.29it/s]
MMSA - VAL-(tfn) >>  Has0_acc_2: 0.7273  Has0_F1_score: 0.6124  Non0_acc_2: 0.7273  Non0_F1_score: 0.6124  Mult_acc_5: 0.6545  Mult_acc_7: 0.6545  MAE: 0.6144  Corr: 0.2956  Loss: 0.5991 
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.98it/s] 38%|███▊      | 6/16 [00:00<00:00, 24.70it/s] 69%|██████▉   | 11/16 [00:00<00:00, 32.47it/s]100%|██████████| 16/16 [00:00<00:00, 36.14it/s]100%|██████████| 16/16 [00:00<00:00, 27.61it/s]
MMSA - TRAIN-(tfn) [2/10/1] >> loss: 0.5276  Has0_acc_2: 0.7930  Has0_F1_score: 0.7652  Non0_acc_2: 0.7930  Non0_F1_score: 0.7652  Mult_acc_5: 0.6953  Mult_acc_7: 0.6953  MAE: 0.5276  Corr: 0.5041 
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 32.73it/s]
MMSA - VAL-(tfn) >>  Has0_acc_2: 0.7273  Has0_F1_score: 0.6124  Non0_acc_2: 0.7273  Non0_F1_score: 0.6124  Mult_acc_5: 0.6727  Mult_acc_7: 0.6727  MAE: 0.6229  Corr: 0.2289  Loss: 0.6402 
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.29it/s] 44%|████▍     | 7/16 [00:00<00:00, 29.41it/s] 75%|███████▌  | 12/16 [00:00<00:00, 36.40it/s]100%|██████████| 16/16 [00:00<00:00, 29.40it/s]
MMSA - TRAIN-(tfn) [3/11/1] >> loss: 0.4658  Has0_acc_2: 0.8203  Has0_F1_score: 0.7933  Non0_acc_2: 0.8203  Non0_F1_score: 0.7933  Mult_acc_5: 0.7695  Mult_acc_7: 0.7695  MAE: 0.4658  Corr: 0.5923 
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 36.23it/s]
MMSA - VAL-(tfn) >>  Has0_acc_2: 0.7273  Has0_F1_score: 0.7171  Non0_acc_2: 0.7273  Non0_F1_score: 0.7171  Mult_acc_5: 0.6545  Mult_acc_7: 0.6545  MAE: 0.6321  Corr: 0.2810  Loss: 0.5720 
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.41it/s] 38%|███▊      | 6/16 [00:00<00:00, 27.18it/s] 69%|██████▉   | 11/16 [00:00<00:00, 35.59it/s]100%|██████████| 16/16 [00:00<00:00, 31.13it/s]
MMSA - TRAIN-(tfn) [4/12/1] >> loss: 0.5329  Has0_acc_2: 0.7773  Has0_F1_score: 0.7372  Non0_acc_2: 0.7773  Non0_F1_score: 0.7372  Mult_acc_5: 0.7188  Mult_acc_7: 0.7188  MAE: 0.5329  Corr: 0.4473 
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 36.44it/s]
MMSA - VAL-(tfn) >>  Has0_acc_2: 0.7273  Has0_F1_score: 0.6124  Non0_acc_2: 0.7273  Non0_F1_score: 0.6124  Mult_acc_5: 0.7273  Mult_acc_7: 0.7273  MAE: 0.6697  Corr: 0.1508  Loss: 0.6418 
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.82it/s] 31%|███▏      | 5/16 [00:00<00:00, 23.05it/s] 75%|███████▌  | 12/16 [00:00<00:00, 42.26it/s]100%|██████████| 16/16 [00:00<00:00, 34.51it/s]
MMSA - TRAIN-(tfn) [5/13/1] >> loss: 0.5446  Has0_acc_2: 0.7852  Has0_F1_score: 0.7343  Non0_acc_2: 0.7852  Non0_F1_score: 0.7343  Mult_acc_5: 0.7500  Mult_acc_7: 0.7500  MAE: 0.5446  Corr: 0.4606 
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 32.51it/s]
MMSA - VAL-(tfn) >>  Has0_acc_2: 0.7091  Has0_F1_score: 0.6829  Non0_acc_2: 0.7091  Non0_F1_score: 0.6829  Mult_acc_5: 0.6727  Mult_acc_7: 0.6727  MAE: 0.6427  Corr: 0.2764  Loss: 0.6734 
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.09it/s] 31%|███▏      | 5/16 [00:00<00:00, 21.81it/s] 75%|███████▌  | 12/16 [00:00<00:00, 38.40it/s]100%|██████████| 16/16 [00:00<00:00, 30.92it/s]
MMSA - TRAIN-(tfn) [6/14/1] >> loss: 0.4662  Has0_acc_2: 0.8125  Has0_F1_score: 0.7920  Non0_acc_2: 0.8125  Non0_F1_score: 0.7920  Mult_acc_5: 0.7539  Mult_acc_7: 0.7539  MAE: 0.4662  Corr: 0.5228 
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 43.13it/s]
MMSA - VAL-(tfn) >>  Has0_acc_2: 0.7091  Has0_F1_score: 0.7145  Non0_acc_2: 0.7091  Non0_F1_score: 0.7145  Mult_acc_5: 0.6182  Mult_acc_7: 0.6182  MAE: 0.6963  Corr: 0.2486  Loss: 0.7077 
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.36it/s] 44%|████▍     | 7/16 [00:00<00:00, 31.29it/s] 75%|███████▌  | 12/16 [00:00<00:00, 38.19it/s]100%|██████████| 16/16 [00:00<00:00, 31.15it/s]
MMSA - TRAIN-(tfn) [7/15/1] >> loss: 0.4861  Has0_acc_2: 0.8047  Has0_F1_score: 0.7833  Non0_acc_2: 0.8047  Non0_F1_score: 0.7833  Mult_acc_5: 0.7656  Mult_acc_7: 0.7656  MAE: 0.4861  Corr: 0.5047 
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 36.29it/s]
MMSA - VAL-(tfn) >>  Has0_acc_2: 0.6545  Has0_F1_score: 0.6635  Non0_acc_2: 0.6545  Non0_F1_score: 0.6635  Mult_acc_5: 0.5818  Mult_acc_7: 0.5818  MAE: 0.6883  Corr: 0.3625  Loss: 0.6277 
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.27it/s] 38%|███▊      | 6/16 [00:00<00:00, 26.51it/s] 75%|███████▌  | 12/16 [00:00<00:00, 36.57it/s]100%|██████████| 16/16 [00:00<00:00, 29.47it/s]
MMSA - TRAIN-(tfn) [8/16/1] >> loss: 0.4815  Has0_acc_2: 0.8047  Has0_F1_score: 0.7815  Non0_acc_2: 0.8047  Non0_F1_score: 0.7815  Mult_acc_5: 0.7344  Mult_acc_7: 0.7344  MAE: 0.4815  Corr: 0.5186 
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 39.60it/s]
MMSA - VAL-(tfn) >>  Has0_acc_2: 0.7455  Has0_F1_score: 0.6530  Non0_acc_2: 0.7455  Non0_F1_score: 0.6530  Mult_acc_5: 0.7273  Mult_acc_7: 0.7273  MAE: 0.5976  Corr: 0.2077  Loss: 0.6391 
  0%|          | 0/4 [00:00<?, ?it/s]100%|██████████| 4/4 [00:00<00:00, 39.83it/s]
MMSA - TEST-(tfn) >>  Has0_acc_2: 0.7091  Has0_F1_score: 0.5884  Non0_acc_2: 0.7091  Non0_F1_score: 0.5884  Mult_acc_5: 0.6364  Mult_acc_7: 0.6364  MAE: 0.6159  Corr: 0.3564  Loss: 0.5825 
MMSA - Result for seed 1111: {'Has0_acc_2': 0.7091, 'Has0_F1_score': 0.5884, 'Non0_acc_2': 0.7091, 'Non0_F1_score': 0.5884, 'Mult_acc_5': 0.6364, 'Mult_acc_7': 0.6364, 'MAE': 0.6159, 'Corr': 0.3564, 'Loss': 0.5825}
MMSA - Results saved to /root/MMSA/results/normal/custom.csv.

======================================================================
训练完成！
======================================================================
结果: None
